databaseChangeLog:
  - changeSet:
      id: advertisement-seq
      author: stoker
      changes:
        - createSequence:
            incrementBy: 1
            sequenceName: ads_seq
  - changeSet:
      id: attachment-seq
      author: stoker
      changes:
        - createSequence:
            incrementBy: 1
            sequenceName: att_seq
  - changeSet:
      id: categories-seq
      author: stoker
      changes:
        - createSequence:
            incrementBy: 1
            sequenceName: categories_seq
  - changeSet:
      id: users-seq
      author: stoker
      changes:
        - createSequence:
            incrementBy: 1
            sequenceName: users_seq
  - changeSet:
      id: advertisements
      author: stoker
      changes:
        - createTable:
            tableName: advertisements
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: advertisementsPK
                  name: id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: user_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: name
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: posted_at
                  type: TIMESTAMP WITHOUT TIME ZONE
  - changeSet:
      id: attachments
      author: stoker
      changes:
        - createTable:
            tableName: attachments
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: attachmentsPK
                  name: id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: uri
                  type: VARCHAR(4096)
              - column:
                  name: product_id
                  type: BIGINT
  - changeSet:
      id: categories
      author: stoker
      changes:
        - createTable:
            tableName: categories
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: categoriesPK
                  name: id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: name
                  type: VARCHAR(255)
              - column:
                  name: category_id
                  type: BIGINT
  - changeSet:
      id: favorites
      author: stoker
      changes:
        - createTable:
            tableName: favorites
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: favoritesPK
                  name: advertisement_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: favoritesPK
                  name: user_id
                  type: BIGINT
  - changeSet:
      id: product_estimations
      author: stoker
      changes:
        - createTable:
            tableName: product_estimations
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: product_estimationsPK
                  name: product_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: product_estimationsPK
                  name: estimating_user_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: estimation
                  type: INTEGER
              - column:
                  name: comment
                  type: VARCHAR(1024)
              - column:
                  constraints:
                    nullable: false
                  name: estimated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
  - changeSet:
      id: products
      author: stoker
      changes:
        - createTable:
            tableName: products
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: productsPK
                  name: advertisement_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: category_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: price
                  type: numeric(19, 2)
              - column:
                  name: description
                  type: VARCHAR(2048)
              - column:
                  name: properties
                  type: JSONB
  - changeSet:
      id: user_estimations
      author: stoker
      changes:
        - createTable:
            tableName: user_estimations
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: user_estimationsPK
                  name: estimated_user_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: user_estimationsPK
                  name: estimating_user_id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: estimation
                  type: INTEGER
              - column:
                  name: comment
                  type: VARCHAR(1024)
              - column:
                  constraints:
                    nullable: false
                  name: estimated_at
                  type: TIMESTAMP WITHOUT TIME ZONE
  - changeSet:
      id: users
      author: stoker
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: usersPK
                  name: id
                  type: BIGINT
              - column:
                  constraints:
                    nullable: false
                  name: login
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: password
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: role
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: email
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: phone
                  type: VARCHAR(20)
              - column:
                  constraints:
                    nullable: false
                  name: firstname
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: lastname
                  type: VARCHAR(255)
              - column:
                  constraints:
                    nullable: false
                  name: birthday
                  type: date
              - column:
                  constraints:
                    nullable: false
                  name: status
                  type: VARCHAR(255)
  - changeSet:
      id: email-unique-index
      author: stoker
      changes:
        - createIndex:
            columns:
              - column:
                  name: email
            indexName: email_uq
            tableName: users
  - changeSet:
      id: login-unique-index
      author: stoker
      changes:
        - createIndex:
            columns:
              - column:
                  name: login
            indexName: login_uq
            tableName: users
  - changeSet:
      id: phone-unique-index
      author: stoker
      changes:
        - createIndex:
            columns:
              - column:
                  name: phone
            indexName: phone_uq
            tableName: users
  - changeSet:
      id: uri-unique-index
      author: stoker
      changes:
        - createIndex:
            columns:
              - column:
                  name: uri
            indexName: uri_uq_idx
            tableName: attachments
  - changeSet:
      id: fk-ads-id-prod-id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: advertisement_id
            baseTableName: products
            constraintName: fk_ads_id_prod_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: advertisements
            validate: true
  - changeSet:
      id: fk_ads_user_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: user_id
            baseTableName: advertisements
            constraintName: fk_ads_user_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: users
            validate: true
  - changeSet:
      id: fk_att_product_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: product_id
            baseTableName: attachments
            constraintName: fk_att_product_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: advertisement_id
            referencedTableName: products
            validate: true
  - changeSet:
      id: fk_cat_category_id_cat_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: category_id
            baseTableName: categories
            constraintName: fk_cat_category_id_cat_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: categories
            validate: true
  - changeSet:
      id: advertisement_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: advertisement_id
            baseTableName: favorites
            constraintName: fk_favorites_ads_id_adss_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: advertisements
            validate: true
  - changeSet:
      id: fk_favorites_user_id_users_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: user_id
            baseTableName: favorites
            constraintName: fk_favorites_user_id_users_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: users
            validate: true
  - changeSet:
      id: fk_prod_cat_id_cat_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: category_id
            baseTableName: products
            constraintName: fk_prod_cat_id_cat_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: categories
            validate: true
  - changeSet:
      id: fk_product_esting_us_id_user_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: estimating_user_id
            baseTableName: product_estimations
            constraintName: fk_product_esting_us_id_user_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: users
            validate: true
  - changeSet:
      id: fk_product_pr_id_product_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: product_id
            baseTableName: product_estimations
            constraintName: fk_product_pr_id_product_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: advertisement_id
            referencedTableName: products
            validate: true
  - changeSet:
      id: fk_user_ested_user_user_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: estimated_user_id
            baseTableName: user_estimations
            constraintName: fk_user_ested_user_user_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: users
            validate: true
  - changeSet:
      id: fk_user_esting_by_user_id
      author: stoker
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: estimating_user_id
            baseTableName: user_estimations
            constraintName: fk_user_esting_by_user_id
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: id
            referencedTableName: users
            validate: true